# -*- coding: utf-8 -*-
"""assignment2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1epVWfIqHDyClbou0ZG5vyRXwfBvOmApl
"""

from google.colab import drive
drive.mount("/content/drive")

# Commented out IPython magic to ensure Python compatibility.
import pandas as pd
import numpy as np
import seaborn as sns
import matplotlib.pyplot as plt
# %matplotlib inline

file=pd.read_csv("/content/drive/MyDrive/dirty.csv")
df=pd.DataFrame(file)

df

df.info()

df.describe()

df.drop(['ID'],axis=1,inplace=True)

df[df.duplicated()]

df.drop_duplicates(keep='first',inplace=True)

df.isna().sum()

df['GENDER']=df['GENDER'].astype('object')
df['MARRITIAL STATUS']=df['MARRITIAL STATUS'].astype('object')
df['COMPANION']=df['COMPANION'].astype('object')
df['TWO_FOUR_WHEELER']=df['TWO_FOUR_WHEELER'].astype('object')
df['CINEMA_LIKES']=df['CINEMA_LIKES'].astype('object')

df.info()

for i in df:
    if df[i].dtype=='object':
        df[i].fillna(df[i].mode()[0],inplace=True)
    else:
        df[i].fillna(df[i].mean(),inplace=True)

df.info()

import matplotlib.pyplot as mtp
import seaborn as sns
sns.pairplot(df,kind='scatter')

sns.heatmap(df,cmap='coolwarm')

df.corr().style.background_gradient(cmap='coolwarm')

fig,ax=mtp.subplots(2,4,figsize=(10,15))
mtp.subplot(2,4,1)
mtp.boxplot(df['GENDER'])
mtp.subplot(2,4,2)
mtp.boxplot(df['MARRITIAL STATUS'])
mtp.subplot(2,4,3)
mtp.boxplot(df['AGE'])
mtp.subplot(2,4,4)
mtp.boxplot(df['COMPANION'])
mtp.subplot(2,4,5)
mtp.boxplot(df['TWO_FOUR_WHEELER'])
mtp.subplot(2,4,6)
mtp.boxplot(df['CINEMA_LIKES'])
mtp.subplot(2,4,7)
mtp.boxplot(df['MONEY'])

for i in df:
    q1=df[i].quantile(0.25)
    q3=df[i].quantile(0.75)
    iqr=q3-q1
    lower=q1-1.5*iqr
    upper=q3+1.5*iqr
    df[i]=np.where(df[i]>upper,upper,df[i])
    df[i]=np.where(df[i]<lower,lower,df[i])

fig,ax=mtp.subplots(2,4,figsize=(10,15))
mtp.subplot(2,4,1)
mtp.boxplot(df['GENDER'])
mtp.subplot(2,4,2)
mtp.boxplot(df['MARRITIAL STATUS'])
mtp.subplot(2,4,3)
mtp.boxplot(df['AGE'])
mtp.subplot(2,4,4)
mtp.boxplot(df['COMPANION'])
mtp.subplot(2,4,5)
mtp.boxplot(df['TWO_FOUR_WHEELER'])
mtp.subplot(2,4,6)
mtp.boxplot(df['CINEMA_LIKES'])
mtp.subplot(2,4,7)
mtp.boxplot(df['MONEY'])

